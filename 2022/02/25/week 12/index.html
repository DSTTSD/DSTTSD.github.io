<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"dsttsd.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="内容：  毕设内容 NCE &amp; InfoNCE  下周内容：  cs224n 生成模型  NCE 多分类问题 nlp中常常将语言模型当做一个多分类问题，经过softmax后的概率可以被看做给出上下文c，下一个单词w的条件概率分布 这里进入softmax以前的结果用表示，那么  [公式]  \(Z(C)\)常被看做”配分函数“或”归一化因子“，单词库大小常常是">
<meta property="og:type" content="article">
<meta property="og:title" content="第十二次周报">
<meta property="og:url" content="https://dsttsd.github.io/2022/02/25/week%2012/index.html">
<meta property="og:site_name" content="DSTの杂货铺">
<meta property="og:description" content="内容：  毕设内容 NCE &amp; InfoNCE  下周内容：  cs224n 生成模型  NCE 多分类问题 nlp中常常将语言模型当做一个多分类问题，经过softmax后的概率可以被看做给出上下文c，下一个单词w的条件概率分布 这里进入softmax以前的结果用表示，那么  [公式]  \(Z(C)\)常被看做”配分函数“或”归一化因子“，单词库大小常常是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p_%7B%5Ctheta%7D%28w%7Cc%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=s_%7B%5Ctheta%7D%28w%2Cc%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=+%5Cbegin%7Baligned%7D+p_%7B%5Ctheta%7D%28w%7Cc%29%26%3D+%5Cfrac%7Bexp%28s_%7B%5Ctheta%7D%28w%2Cc%29%29%7D%7B%5Csum_%7Bw%5E%5Cprime+%5Cin+V%7Dexp%28s_%7B%5Ctheta%7D%28w%2Cc%29%29%7D+%5C%5C+%26%3D+%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7BZ%28c%29%7D+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%7CV%7C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D++%5Carg%5Cmax+%5Cmathcal%7BL%7D_%7BMLE%7D+%26%3D+%5Carg%5Cmax+%5Csum_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Clog+p_%7B%5Ctheta%7D%28w+%5Cmid+c%29+%5C%5C+%26%3D%5Carg%5Cmax+%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7BZ%28c%29%7D%7D+%5Cend%7Baligned%7D+%5">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Cmathcal%7BL%7D_%7B%5Cmathrm%7BMLE%7D%7D%26%3D%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7BZ%28c%29%7D%7D+%5C%5C+%26%3D%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cleft%5B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D-+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7BZ%28c%29%7D+%5Cright%5D+%5C%5C+%26%3D%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+-++%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Clog%7BZ%28c%29%7D+%5Cend%7Baligned%7D+%5">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Ctilde%7Bp%7D%28w%7Cc%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=D%3D1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=q%28w%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=D%3D0">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p%28w%7Cc%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=k_d">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=k_n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+p%28D%3D0%7Cw%2Cc%29+%26%3D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7B%5Ctilde%7Bp%7D%28w+%5Cmid+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%5C%5C++p%28D%3D1%7Cw%2Cc%29+%26%3D%5Cfrac%7B%5Ctilde%7Bp%7D%28w+%5Cmid+c%29%7D%7B%5Ctilde%7Bp%7D%28w+%5Cmid+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=D_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathcal%7BL%7D%5Ec_%7B%5Cmathrm%7BNCE%7D%7D+%26%3D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%2Bk_n%7D+%5Cleft%5B+D_t+%5Clog+P%28D%3D1%7Cw_t%2Cc%29+%2B%281-D_t%29+%5Clog+P%28D%3D0%7Cw_t%2Cc%29+%5Cright%5D+%5C%5C+%26%3D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%7D%5Clog+P%28D%3D1%7Cw_t%2Cc%29+%2B+%5Csum_%7Bt%3D1%7D%5E%7Bk_n%7D+%5Clog+P%28D%3D0%7Cw_t%2Cc%29+%5C%5C+%26%3D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%7D%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%2B+%5Csum_%7Bt%3D1%7D%5E%7Bk_n%7D+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+J%5Ec_%7BNCE%7D+%26%3D%5Cfrac%7B1%7D%7Bk_d%7D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%7D%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%2B+%5Cfrac%7Bk%7D%7Bk_n%7D+%5Csum_%7Bt%3D1%7D%5E%7Bk_n%7D+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%26%3D%5Cmathbb%7BE%7D_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%2B+k+%5Cmathbb%7BE%7D_%7Bw+%5Csim+q%28w%29%7D+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+J%5Ec_%7BNCE%7D%28%5Ctheta%29%26%3D++%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Cleft%5B%5Cmathbb%7BE%7D_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D%7B%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D%7D+%2B+k%5Cmathbb%7BE%7D_%7Bw+%5Csim+q%28w%29%7D+%7B%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D%7D+%5Cright%5D+%5C%5C+%26%3D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29+%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%2B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+k%5Csum_%7Bw%7Dq%28w%29+%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%5C%5C+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%2B+k%5Csum_%7Bw%7Dq%28w%29+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%5C%5C+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+log%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28%7Bw%7D%29%7D%7D++%26%3D+-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog%7B%281%2B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bk+%5Ctimes+q%28%7Bw%7D%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7D+%28k+%5Ctimes+q%28w%29%29+%5Cfrac%7B-1%7D+%7B%5Bu_%7B%5Ctheta%7D%28w%2Cc%29%5D%5E2%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D+%5C%5C+%26%3D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+log%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+log%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D++%26%3D-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog%7B%281%2B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D%7D+%5Cfrac%7B1%7D%7Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Du_%7B%5Ctheta%7D%28w%2Cc%29+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Du_%7B%5Ctheta%7D%28w%2Cc%29+%5C%5C+%26%3D-%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Du_%7B%5Ctheta%7D%28w%2Cc%29+%5C%5C+%26%3D-%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+J%5Ec_%7BNCE%7D%28%5Ctheta%29+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%2B+k%5Csum_%7Bw%7Dq%28w%29+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%5C%5C+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+-+k%5Csum_%7Bw%7Dq%28w%29+%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+-+%5Csum_%7Bw%7D+u_%7B%5Ctheta%7D%28w%2Cc%29++%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D%5Csum_w%7B%5Cleft%5B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cleft%28%5Ctilde%7Bp%7D%28w%7Cc%29-+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%5D%7D+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=Z%28c%29%5Capprox1">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=z_c">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p_%7B%5Ctheta%7D%28w%7Cc%29%3Du_%7B%5Ctheta%7D%28w%2Cc%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Clim_%7Bk+%5Cto+%5Cinfty%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+J%5Ec_%7BNCE%7D%28%5Ctheta%29+%26%3D%5Clim_%7Bk+%5Cto+%5Cinfty%7D+%5Csum_w%7B%5Cleft%5B%5Cfrac%7Bq%28w%29%7D%7B+%5Cfrac%7Bp_%7B%5Ctheta%7D%28w%7Cc%29%7D%7Bk%7D%2Bq%28w%29%7D+%5Cleft%28%5Ctilde%7Bp%7D%28w%7Cc%29-+p_%7B%5Ctheta%7D%28w%7Cc%29%5Cright%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%5D%7D+%5C%5C+%26%3D+%5Csum_w%7B%5Cleft%5B%5Cleft%28%5Ctilde%7Bp%7D%28w%7Cc%29-+p_%7B%5Ctheta%7D%28w%7Cc%29%5Cright%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%5D%7D+%5Cend%7Baligned%7D+%5Ctag+%7B24%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%7Cc_t%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=k">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=x_%7Bt%2Bk%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=x_%7Bt%2Bk%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+I%28x_%7Bt%2Bk%7D+%3B+c_t%29%3D%5Csum_%7Bx%2C+c%7D+p%28x_%7Bt%2Bk%7D%2C+c_t%29+%5Clog+%5Cfrac%7Bp%28x_%7Bt%2Bk%7D+%5Cmid+c_t%29%7D%7Bp%28x_%7Bt%2Bk%7D%29%7D+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cfrac%7Bp%28x_%7Bt%2Bk%7D+%5Cmid+c_t%29%7D%7Bp%28x_%7Bt%2Bk%7D%29%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%7Cc_t%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p_d">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p_n">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D+%5Cmid+c_t%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=k">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+p%28x_%7Bt%2Bk%7D%7Cc_t%29%26%3D+%5Cfrac%7Bexp%28s_%7B%5Ctheta%7D%28x_%7Bt%2Bk%7D%2Cc_t%29%29%7D%7B%5Csum_%7Bx_j+%5Cin+X%7Dexp%28s_%7B%5Ctheta%7D%28x_%7Bj%7D%2Cc_t%29%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=s_%7B%5Ctheta%7D%28x%2Cc%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=x">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=exp%28s_%7B%5Ctheta%7D%28x_%7Bt%2Bk%7D%2Cc_t%29%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=+f_k%28x_%7Bt%2Bk%7D%2Cc_t%29">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+p%28x_%7Bt%2Bk%7D%7Cc_t%29%26%3D+%5Cfrac%7Bf_k%28x_%7Bt%2Bk%7D%2Cc_t%29%7D%7B%5Csum_%7Bx_j+%5Cin+X%7Df_k%28x_%7Bj%7D%2Cc_t%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathcal%7BL%7D_%7BN%7D%26%3D-%5Csum_%7BX%7D%5Cleft%5Bp%28x%2Cc%29%5Clog+%5Cfrac%7Bf_%7Bk%7D%5Cleft%28x_%7Bt%2Bk%7D%2C+c_%7Bt%7D%5Cright%29%7D%7B%5Csum_%7Bx_%7Bj%7D+%5Cin+X%7D+f_%7Bk%7D%5Cleft%28x_%7Bj%7D%2C+c_%7Bt%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%26%3D-%5Cmathbb%7BE%7D_X%5Cleft%5B%5Clog+%5Cfrac%7Bf_%7Bk%7D%5Cleft%28x_%7Bt%2Bk%7D%2C+c_%7Bt%7D%5Cright%29%7D%7B%5Csum_%7Bx_%7Bj%7D+%5Cin+X%7D+f_%7Bk%7D%5Cleft%28x_%7Bj%7D%2C+c_%7Bt%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%5Cend%7Baligned%7D+%5C">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=x_%7Bt%2Bk%7D">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=c_t">
<meta property="og:image" content="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathcal%7BL%7D_%7B%5Cmathrm%7BN%7D%7D%5E%7B%5Cmathrm%7Bopt%7D%7D+%26%3D-%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B%5Cfrac%7B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7D%7B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%2B%5Csum_%7Bx_%7Bj%7D+%5Cin+X_%7B%5Cmathrm%7Bneg%7D%7D%7D+%5Cfrac%7Bp%5Cleft%28x_%7Bj%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bj%7D%5Cright%29%7D%7D%5Cright%5D+%5C%5C+%26%3D%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B1%2B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D+%5Csum_%7Bx_%7Bj%7D+%5Cin+X_%7B%5Cmathrm%7Bneg%7D%7D%7D+%5Cfrac%7Bp%5Cleft%28x_%7Bj%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bj%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%26+%5Capprox+%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B1%2B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%28N-1%29+%5Cunderset%7Bx_%7Bj%7D%7D%7B%5Cmathbb%7BE%7D%7D+%5Cfrac%7Bp%5Cleft%28x_%7Bj%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bj%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%26%3D%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B1%2B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%28N-1%29%5Cright%5D+%5C%5C+%26+%5Cgeq+%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D+N%5Cright%5D+%5C%5C+%26%3D-I%5Cleft%28x_%7Bt%2Bk%7D%2C+c_%7Bt%7D%5Cright%29%2B%5Clog+%28N%29+%5Cend%7Baligned%7D+%5C">
<meta property="article:published_time" content="2022-02-25T04:15:55.000Z">
<meta property="article:modified_time" content="2022-06-28T04:09:27.615Z">
<meta property="article:author" content="DST">
<meta property="article:tag" content="周报">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.zhihu.com/equation?tex=p_%7B%5Ctheta%7D%28w%7Cc%29">


<link rel="canonical" href="https://dsttsd.github.io/2022/02/25/week%2012/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dsttsd.github.io/2022/02/25/week%2012/","path":"2022/02/25/week 12/","title":"第十二次周报"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>第十二次周报 | DSTの杂货铺</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DSTの杂货铺</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">学习笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">2</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">10</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#nce"><span class="nav-number">1.</span> <span class="nav-text">NCE</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98"><span class="nav-number">1.1.</span> <span class="nav-text">多分类问题</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#nce%E5%AF%B9%E4%BA%8E%E9%87%87%E6%A0%B7%E7%9A%84%E5%BB%BA%E6%A8%A1"><span class="nav-number">1.2.</span> <span class="nav-text">NCE对于采样的建模</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#nce%E5%8E%9F%E7%90%86"><span class="nav-number">1.3.</span> <span class="nav-text">NCE原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.4.</span> <span class="nav-text">实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#infonce-cpc"><span class="nav-number"></span> <span class="nav-text">InfoNce  CPC</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%BB%E5%8A%A1%E5%92%8C%E7%9B%AE%E7%9A%84"><span class="nav-number">0.1.</span> <span class="nav-text">任务和目的</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%8E%E4%BA%92%E4%BF%A1%E6%81%AF%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">0.2.</span> <span class="nav-text">与互信息的关系</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%8Emine%E5%85%B3%E7%B3%BB"><span class="nav-number">0.3.</span> <span class="nav-text">与MINE关系</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DST"
      src="https://avatars.githubusercontent.com/u/50662067?s=400&u=b552d8b742d1e685ed0ddcc6a97d9f697535fa6b&v=4">
  <p class="site-author-name" itemprop="name">DST</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/DSTTSD" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;DSTTSD" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dsttsd.github.io/2022/02/25/week%2012/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://avatars.githubusercontent.com/u/50662067?s=400&u=b552d8b742d1e685ed0ddcc6a97d9f697535fa6b&v=4">
      <meta itemprop="name" content="DST">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DSTの杂货铺">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          第十二次周报
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-02-25 12:15:55" itemprop="dateCreated datePublished" datetime="2022-02-25T12:15:55+08:00">2022-02-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-06-28 12:09:27" itemprop="dateModified" datetime="2022-06-28T12:09:27+08:00">2022-06-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%91%A8%E6%8A%A5/" itemprop="url" rel="index"><span itemprop="name">周报</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>内容：</p>
<ul>
<li><p>毕设内容</p></li>
<li><p>NCE &amp; InfoNCE</p></li>
</ul>
<p>下周内容：</p>
<ul>
<li>cs224n 生成模型</li>
</ul>
<h4 id="nce">NCE</h4>
<h5 id="多分类问题">多分类问题</h5>
<p>nlp中常常将语言模型当做一个多分类问题，经过softmax后的概率可以被看做给出上下文c，下一个单词w的条件概率分布<img src="https://www.zhihu.com/equation?tex=p_%7B%5Ctheta%7D%28w%7Cc%29" alt="[公式]" /></p>
<p>这里进入softmax以前的结果用<img src="https://www.zhihu.com/equation?tex=s_%7B%5Ctheta%7D%28w%2Cc%29" alt="[公式]" />表示，那么</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=+%5Cbegin%7Baligned%7D+p_%7B%5Ctheta%7D%28w%7Cc%29%26%3D+%5Cfrac%7Bexp%28s_%7B%5Ctheta%7D%28w%2Cc%29%29%7D%7B%5Csum_%7Bw%5E%5Cprime+%5Cin+V%7Dexp%28s_%7B%5Ctheta%7D%28w%2Cc%29%29%7D+%5C%5C+%26%3D+%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7BZ%28c%29%7D+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p><span class="math inline">\(Z(C)\)</span>常被看做”配分函数“或”归一化因子“，单词库大小<img src="https://www.zhihu.com/equation?tex=%7CV%7C" alt="[公式]" />常常是很大的，因此该项往往很难直接计算。（如果把配分项看做参数学习，会趋向于零完全失效)</p>
<p>回顾极大似然估计：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D++%5Carg%5Cmax+%5Cmathcal%7BL%7D_%7BMLE%7D+%26%3D+%5Carg%5Cmax+%5Csum_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Clog+p_%7B%5Ctheta%7D%28w+%5Cmid+c%29+%5C%5C+%26%3D%5Carg%5Cmax+%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7BZ%28c%29%7D%7D+%5Cend%7Baligned%7D+%5" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p>对<span class="math inline">\(\theta\)</span>求导：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Cmathcal%7BL%7D_%7B%5Cmathrm%7BMLE%7D%7D%26%3D%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7BZ%28c%29%7D%7D+%5C%5C+%26%3D%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cleft%5B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D-+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7BZ%28c%29%7D+%5Cright%5D+%5C%5C+%26%3D%5Cmathbb+E_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+-++%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Clog%7BZ%28c%29%7D+%5Cend%7Baligned%7D+%5" alt="" /><figcaption>[公式]</figcaption>
</figure>
<h5 id="nce对于采样的建模">NCE对于采样的建模</h5>
<p>Noise Contrastive Estimation（噪声对比估计）的<strong>核心思想就是通过学习数据分布样本和噪声分布样本之间的区别，从而发现数据中的一些特性</strong>，将问题转换成了一个二分类问题，分类器能够对数据样本和噪声样本进行二分类。</p>
<p>假设一个特定上下文 <img src="https://www.zhihu.com/equation?tex=c" alt="[公式]" /> 的数据分布为 <img src="https://www.zhihu.com/equation?tex=%5Ctilde%7Bp%7D%28w%7Cc%29" alt="[公式]" />，从该分布采样的样本为正样本，记<img src="https://www.zhihu.com/equation?tex=D%3D1" alt="[公式]" />，另一个与上下文无关的噪声分布为<img src="https://www.zhihu.com/equation?tex=q%28w%29" alt="[公式]" /></p>
<p>，从该分布取出的是负样本，记为 <img src="https://www.zhihu.com/equation?tex=D%3D0" alt="[公式]" />假设现在取出了若干正负样本组成一个混合分布 <img src="https://www.zhihu.com/equation?tex=p%28w%7Cc%29" alt="[公式]" />，<strong>负样本与正样本</strong>之比为k（正样本<img src="https://www.zhihu.com/equation?tex=k_d" alt="[公式]" />个，负样本<img src="https://www.zhihu.com/equation?tex=k_n" alt="[公式]" />个)，那么有：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+p%28D%3D0%7Cw%2Cc%29+%26%3D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7B%5Ctilde%7Bp%7D%28w+%5Cmid+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%5C%5C++p%28D%3D1%7Cw%2Cc%29+%26%3D%5Cfrac%7B%5Ctilde%7Bp%7D%28w+%5Cmid+c%29%7D%7B%5Ctilde%7Bp%7D%28w+%5Cmid+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p>假设标签 <img src="https://www.zhihu.com/equation?tex=D_t" alt="[公式]" /> （属于哪一个分布）为伯努利分布，那么它的对数似然函数（取负值为交叉熵损失)：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathcal%7BL%7D%5Ec_%7B%5Cmathrm%7BNCE%7D%7D+%26%3D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%2Bk_n%7D+%5Cleft%5B+D_t+%5Clog+P%28D%3D1%7Cw_t%2Cc%29+%2B%281-D_t%29+%5Clog+P%28D%3D0%7Cw_t%2Cc%29+%5Cright%5D+%5C%5C+%26%3D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%7D%5Clog+P%28D%3D1%7Cw_t%2Cc%29+%2B+%5Csum_%7Bt%3D1%7D%5E%7Bk_n%7D+%5Clog+P%28D%3D0%7Cw_t%2Cc%29+%5C%5C+%26%3D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%7D%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%2B+%5Csum_%7Bt%3D1%7D%5E%7Bk_n%7D+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p>目标函数需要除以正样本数目（利用大数定律可以看做是期望）：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+J%5Ec_%7BNCE%7D+%26%3D%5Cfrac%7B1%7D%7Bk_d%7D%5Csum_%7Bt%3D1%7D%5E%7Bk_d%7D%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%2B+%5Cfrac%7Bk%7D%7Bk_n%7D+%5Csum_%7Bt%3D1%7D%5E%7Bk_n%7D+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%26%3D%5Cmathbb%7BE%7D_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D+%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%2B+k+%5Cmathbb%7BE%7D_%7Bw+%5Csim+q%28w%29%7D+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<h5 id="nce原理">NCE原理</h5>
<p>将目标函数对<span class="math inline">\(\theta\)</span> 求导：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+J%5Ec_%7BNCE%7D%28%5Ctheta%29%26%3D++%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Cleft%5B%5Cmathbb%7BE%7D_%7Bw+%5Csim+%5Ctilde%7Bp%7D%28w%7Cc%29%7D%7B%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D%7D+%2B+k%5Cmathbb%7BE%7D_%7Bw+%5Csim+q%28w%29%7D+%7B%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D%7D+%5Cright%5D+%5C%5C+%26%3D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29+%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%2B+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+k%5Csum_%7Bw%7Dq%28w%29+%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%5C%5C+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%2B+k%5Csum_%7Bw%7Dq%28w%29+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%5C%5C+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p>对于上面两项继续求导：</p>
<ol type="1">
<li><figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+log%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28%7Bw%7D%29%7D%7D++%26%3D+-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog%7B%281%2B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bk+%5Ctimes+q%28%7Bw%7D%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7D+%28k+%5Ctimes+q%28w%29%29+%5Cfrac%7B-1%7D+%7B%5Bu_%7B%5Ctheta%7D%28w%2Cc%29%5D%5E2%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D+%5C%5C+%26%3D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+log%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure></li>
<li><figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+log%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D++%26%3D-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog%7B%281%2B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D%7D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7B1%2B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bk+%5Ctimes+q%28w%29%7D%7D+%5Cfrac%7B1%7D%7Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Du_%7B%5Ctheta%7D%28w%2Cc%29+%5C%5C+%26%3D-%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Du_%7B%5Ctheta%7D%28w%2Cc%29+%5C%5C+%26%3D-%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B1%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Du_%7B%5Ctheta%7D%28w%2Cc%29+%5C%5C+%26%3D-%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure></li>
</ol>
<p>将上述式子带回目标函数求导结果：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+J%5Ec_%7BNCE%7D%28%5Ctheta%29+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%2B+k%5Csum_%7Bw%7Dq%28w%29+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D++%5Clog%7B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D%7D+%5C%5C+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+-+k%5Csum_%7Bw%7Dq%28w%29+%5Cfrac%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D%5Csum_%7Bw%7D+%5Ctilde%7Bp%7D%28w%7Cc%29+%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+-+%5Csum_%7Bw%7D+u_%7B%5Ctheta%7D%28w%2Cc%29++%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2Cc%29+%2B+k+%5Ctimes+q%28w%29%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D%5Clog%7Bu_%7B%5Ctheta%7D%28w%2Cc%29%7D+%5C%5C+%26%3D%5Csum_w%7B%5Cleft%5B%5Cfrac%7Bk+%5Ctimes+q%28w%29%7D%7Bu_%7B%5Ctheta%7D%28w%2C+c%29%2Bk+%5Ctimes+q%28w%29%7D+%5Cleft%28%5Ctilde%7Bp%7D%28w%7Cc%29-+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%5D%7D+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p>此处存在两个细节：</p>
<ol type="1">
<li><p>假设配分项<img src="https://www.zhihu.com/equation?tex=Z%28c%29%5Capprox1" alt="[公式]" />（对于参数很多的神经网络来说，配分项每次求梯度时可看做固定的，我们将 <img src="https://www.zhihu.com/equation?tex=z_c" alt="[公式]" /> 固定为 1 对每个 <img src="https://www.zhihu.com/equation?tex=c" alt="[公式]" /> 仍是有效的)。</p>
<p>$</p>
<span class="math display">\[\begin{aligned}
p_{\theta}(w \mid c) &amp;=\frac{\exp \left(s_{\theta}(w, c)\right)}{\sum_{w^{\prime} \in V} \exp \left(s_{\theta}(w, c)\right)} \\
&amp;=\exp \left(s_{\theta}(w, c)\right)\times \exp \left(\theta_{0}\right)\\ 
\end{aligned}\]</span>
<p>$</p>
<p>上述式子对<span class="math inline">\(\theta\)</span> 求导只有第一项的内容，因此后面部分看做是1在梯度更新时是有利的。</p>
<p>如此一来：<img src="https://www.zhihu.com/equation?tex=p_%7B%5Ctheta%7D%28w%7Cc%29%3Du_%7B%5Ctheta%7D%28w%2Cc%29" alt="[公式]" /></p></li>
<li><p>当<span class="math inline">\(k\to \infty\)</span>时，<span class="math inline">\(\frac{k \times q(w)}{p_{\theta}(w, c)+k \times q(w)}\)</span>的极限为1。</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Clim_%7Bk+%5Cto+%5Cinfty%7D+%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7D+J%5Ec_%7BNCE%7D%28%5Ctheta%29+%26%3D%5Clim_%7Bk+%5Cto+%5Cinfty%7D+%5Csum_w%7B%5Cleft%5B%5Cfrac%7Bq%28w%29%7D%7B+%5Cfrac%7Bp_%7B%5Ctheta%7D%28w%7Cc%29%7D%7Bk%7D%2Bq%28w%29%7D+%5Cleft%28%5Ctilde%7Bp%7D%28w%7Cc%29-+p_%7B%5Ctheta%7D%28w%7Cc%29%5Cright%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%5D%7D+%5C%5C+%26%3D+%5Csum_w%7B%5Cleft%5B%5Cleft%28%5Ctilde%7Bp%7D%28w%7Cc%29-+p_%7B%5Ctheta%7D%28w%7Cc%29%5Cright%29%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial+%5Ctheta%7Dlog+u_%7B%5Ctheta%7D%28w%2Cc%29%5Cright%5D%7D+%5Cend%7Baligned%7D+%5Ctag+%7B24%7D" alt="" /><figcaption>[公式]</figcaption>
</figure></li>
</ol>
<h5 id="实现">实现</h5>
<p>实现时：一般正例采样一次，负例采样k次。</p>
<h3 id="infonce-cpc">InfoNce  CPC</h3>
<p>https://arxiv.org/abs/1807.03748</p>
<h5 id="任务和目的">任务和目的</h5>
<p>CPC(对比预测编码) 就是一种通过无监督任务来学习(编码)高维数据的特征表示(representation)，而通常采取的无监督策略就是根据上下文预测未来或者缺失的信息（nlp中早有分布式表示的概念）。 <img src="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%7Cc_t%29" alt="[公式]" /> 表示根据当前上下文 <img src="https://www.zhihu.com/equation?tex=c_t" alt="[公式]" /> 预测 <img src="https://www.zhihu.com/equation?tex=k" alt="[公式]" /> 个时刻后的数据 <img src="https://www.zhihu.com/equation?tex=x_%7Bt%2Bk%7D" alt="[公式]" /> （假设是像文本、语音中那样的<strong>序列数据</strong>)，可以通过<strong>最大化当前上下文</strong> <img src="https://www.zhihu.com/equation?tex=c_t" alt="[公式]" /> <strong>和要未来的数据</strong> <img src="https://www.zhihu.com/equation?tex=x_%7Bt%2Bk%7D" alt="[公式]" /> <strong>之间的互信息</strong>来构建预测任务。</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+I%28x_%7Bt%2Bk%7D+%3B+c_t%29%3D%5Csum_%7Bx%2C+c%7D+p%28x_%7Bt%2Bk%7D%2C+c_t%29+%5Clog+%5Cfrac%7Bp%28x_%7Bt%2Bk%7D+%5Cmid+c_t%29%7D%7Bp%28x_%7Bt%2Bk%7D%29%7D+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p>其中联合分布本身是intractable的，但是我们可以从<img src="https://www.zhihu.com/equation?tex=%5Cfrac%7Bp%28x_%7Bt%2Bk%7D+%5Cmid+c_t%29%7D%7Bp%28x_%7Bt%2Bk%7D%29%7D" alt="[公式]" />入手，这个比例可以被看做密度比（<strong>即贝叶斯中的似然比，给定上下文c第k个单词为<span class="math inline">\(x_{t+k}\)</span>的概率，比一般群体多了多少</strong>)，分子 <img src="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%7Cc_t%29" alt="[公式]" /> 就相当于 <img src="https://www.zhihu.com/equation?tex=p_d" alt="[公式]" /> ，是我们想得到的目标函数；分母 <img src="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%29" alt="[公式]" /> 就相当于 <img src="https://www.zhihu.com/equation?tex=p_n" alt="[公式]" /> ，是用来进行对比的参考分布(噪声)。因此类似NCE，将问题转化为二分类问题：</p>
<ol type="1">
<li>从条件 <img src="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D+%5Cmid+c_t%29" alt="[公式]" /> 中取出数据称为“正样本”，它是根据上下文 <img src="https://www.zhihu.com/equation?tex=c_t" alt="[公式]" /> 所做出的预测数据，将它和这个上下文一起组成“正样本对”，类别标签设为 1。</li>
<li>将从 <img src="https://www.zhihu.com/equation?tex=p%28x_%7Bt%2Bk%7D%29" alt="[公式]" /> 中取出的样本称为“负样本”，它是与当前上下文 <img src="https://www.zhihu.com/equation?tex=c_t" alt="[公式]" /> 没有必然关系的随机数据，将它和这个上下文 <img src="https://www.zhihu.com/equation?tex=c_t" alt="[公式]" /> 一起组成“负样本对”，类别标签设为 0。</li>
<li>正样本也就是与 <img src="https://www.zhihu.com/equation?tex=c_t" alt="[公式]" /> 间隔固定步长 <img src="https://www.zhihu.com/equation?tex=k" alt="[公式]" /> 的数据，根据 NCE 中说明的设定，正样本选取 1 个；因为在 NCE 中证明了噪声分布与数据分布越接近越好，所以负样本就直接在当前序列中随机选取（只要不是那一个正样本就行），负样本数量越多越好。</li>
</ol>
<p>同样可以按照NCE中的写法：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+p%28x_%7Bt%2Bk%7D%7Cc_t%29%26%3D+%5Cfrac%7Bexp%28s_%7B%5Ctheta%7D%28x_%7Bt%2Bk%7D%2Cc_t%29%29%7D%7B%5Csum_%7Bx_j+%5Cin+X%7Dexp%28s_%7B%5Ctheta%7D%28x_%7Bj%7D%2Cc_t%29%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p><img src="https://www.zhihu.com/equation?tex=s_%7B%5Ctheta%7D%28x%2Cc%29" alt="[公式]" /> 是一个 socring function ，输出的分数用来量化 <img src="https://www.zhihu.com/equation?tex=x" alt="[公式]" /> 在上下文 <img src="https://www.zhihu.com/equation?tex=c" alt="[公式]" /> 中匹配性（NCE例子中是神经网络)， CPC 文章中用余弦相似度来量化，并且将 <img src="https://www.zhihu.com/equation?tex=exp%28s_%7B%5Ctheta%7D%28x_%7Bt%2Bk%7D%2Cc_t%29%29" alt="[公式]" /> 定义为 <img src="https://www.zhihu.com/equation?tex=+f_k%28x_%7Bt%2Bk%7D%2Cc_t%29" alt="[公式]" />：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+p%28x_%7Bt%2Bk%7D%7Cc_t%29%26%3D+%5Cfrac%7Bf_k%28x_%7Bt%2Bk%7D%2Cc_t%29%7D%7B%5Csum_%7Bx_j+%5Cin+X%7Df_k%28x_%7Bj%7D%2Cc_t%29%7D+%5C%5C+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<p>写为交叉熵损失，得到：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathcal%7BL%7D_%7BN%7D%26%3D-%5Csum_%7BX%7D%5Cleft%5Bp%28x%2Cc%29%5Clog+%5Cfrac%7Bf_%7Bk%7D%5Cleft%28x_%7Bt%2Bk%7D%2C+c_%7Bt%7D%5Cright%29%7D%7B%5Csum_%7Bx_%7Bj%7D+%5Cin+X%7D+f_%7Bk%7D%5Cleft%28x_%7Bj%7D%2C+c_%7Bt%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%26%3D-%5Cmathbb%7BE%7D_X%5Cleft%5B%5Clog+%5Cfrac%7Bf_%7Bk%7D%5Cleft%28x_%7Bt%2Bk%7D%2C+c_%7Bt%7D%5Cright%29%7D%7B%5Csum_%7Bx_%7Bj%7D+%5Cin+X%7D+f_%7Bk%7D%5Cleft%28x_%7Bj%7D%2C+c_%7Bt%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<h5 id="与互信息的关系">与互信息的关系</h5>
<p>对于互信息的利用一般分为两类：</p>
<ol type="1">
<li><p>优化互信息上界（upper bound）,一般作为正则项在pretrain使用，优化下游任务（较少）。</p>
<p>Cheng P, Hao W, Dai S, et al. Club: A contrastive log-ratio upper bound of mutual information[C]//International conference on machine learning. PMLR, 2020: 1779-1788.</p></li>
<li><p>优化lower bound, 互信息本身是intractable，因此转化为优化lower bound</p>
<p>Poole B, Ozair S, Van Den Oord A, et al. On variational bounds of mutual information[C]//International Conference on Machine Learning. PMLR, 2019: 5171-5180.</p></li>
</ol>
<p>InfoNCE是第二种互信息估计，最小化 InfoNCE，也就等价于最大化 <img src="https://www.zhihu.com/equation?tex=x_%7Bt%2Bk%7D" alt="[公式]" /> 和 <img src="https://www.zhihu.com/equation?tex=c_t" alt="[公式]" /> 之间互信息的下限：</p>
<figure>
<img src="https://www.zhihu.com/equation?tex=%5Cbegin%7Baligned%7D+%5Cmathcal%7BL%7D_%7B%5Cmathrm%7BN%7D%7D%5E%7B%5Cmathrm%7Bopt%7D%7D+%26%3D-%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B%5Cfrac%7B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7D%7B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%2B%5Csum_%7Bx_%7Bj%7D+%5Cin+X_%7B%5Cmathrm%7Bneg%7D%7D%7D+%5Cfrac%7Bp%5Cleft%28x_%7Bj%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bj%7D%5Cright%29%7D%7D%5Cright%5D+%5C%5C+%26%3D%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B1%2B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D+%5Csum_%7Bx_%7Bj%7D+%5Cin+X_%7B%5Cmathrm%7Bneg%7D%7D%7D+%5Cfrac%7Bp%5Cleft%28x_%7Bj%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bj%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%26+%5Capprox+%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B1%2B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%28N-1%29+%5Cunderset%7Bx_%7Bj%7D%7D%7B%5Cmathbb%7BE%7D%7D+%5Cfrac%7Bp%5Cleft%28x_%7Bj%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bj%7D%5Cright%29%7D%5Cright%5D+%5C%5C+%26%3D%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B1%2B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D%28N-1%29%5Cright%5D+%5C%5C+%26+%5Cgeq+%5Cunderset%7BX%7D%7B%5Cmathbb%7BE%7D%7D+%5Clog+%5Cleft%5B%5Cfrac%7Bp%5Cleft%28x_%7Bt%2Bk%7D%5Cright%29%7D%7Bp%5Cleft%28x_%7Bt%2Bk%7D+%5Cmid+c_%7Bt%7D%5Cright%29%7D+N%5Cright%5D+%5C%5C+%26%3D-I%5Cleft%28x_%7Bt%2Bk%7D%2C+c_%7Bt%7D%5Cright%29%2B%5Clog+%28N%29+%5Cend%7Baligned%7D+%5C" alt="" /><figcaption>[公式]</figcaption>
</figure>
<h5 id="与mine关系">与MINE关系</h5>
<p>这篇论文中作者还将infoNCE与MINE(另一个互信息估计)做了比较，infoNCE比MINE多了个常数。对于复杂任务，两者效果都很好，但对于简单任务MINE会不稳定。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%91%A8%E6%8A%A5/" rel="tag"># 周报</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/02/18/week%2011/" rel="prev" title="第十一次周报">
                  <i class="fa fa-chevron-left"></i> 第十一次周报
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DST</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","perpage":true,"js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
